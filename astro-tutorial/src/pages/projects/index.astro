---
import { getCollection } from "astro:content"
import "../styles/tailwind.css"

import BaseLayout from '../../layouts/BaseLayout.astro.jsx';
import ProjectCard from '../../components/ProjectCard.astro.jsx'
import FilterMenu from "../../components/FilterMenu.astro.jsx";

import {extractUniqueTags} from "../../utils/tagManipulation.js"

const pageTitle = "OSSI-supported projects"
const allProjects = await getCollection('projects')
const allProjectTags = await getCollection("tags")
const uniqueTags = extractUniqueTags(allProjectTags)


---
<BaseLayout pageTitle={pageTitle}>
	<p>List of project tags</p>
    <section class="grid grid-cols-3 gap-4">
        <section class="col-span-1">
            <FilterMenu uniqueTags={uniqueTags}/>
        </section>
        <section class="col-start-2 col-span-2 grid grid-cols-2 auto-rows-max gap-4" id="projectCards">
            {allProjects.map((project) => (
                <ProjectCard 
                    url={`/projects/${project.slug}/`} 
                    title={project.data.title} 
                    imgUrl={project.data.image.url}
                    imgAlt={project.data.image.alt}
                    author={project.data.author}
                    description={project.data.description}
                    tags={allProjectTags.find(tag => tag.id === project.data.tags.id)}
                />
            ))}
        </section>
    </section>
    <script>
        import '../scripts/filterMenu.js';
    </script>
</BaseLayout>
