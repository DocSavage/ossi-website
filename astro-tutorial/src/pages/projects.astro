---
import { getCollection } from "astro:content"

import BaseLayout from '../layouts/BaseLayout.astro';
import ProjectCard from '../components/ProjectCard.astro'
import FilterMenu from "../components/FilterMenu.astro";

import {extractUniqueTags} from "../utils/tagManipulation.js"

const pageTitle = "OSSI-supported projects"
const allProjects = await getCollection('projects')
const allProjectTags = await getCollection("tags")
const uniqueTags = extractUniqueTags(allProjectTags)


---
<BaseLayout pageTitle={pageTitle}>
	<p>List of project tags</p>
    <FilterMenu uniqueTags={uniqueTags}/>
    <!-- <p>
        {Object.keys(uniqueTags).map(key => (
            <div>
                <h2 class="font-bold">{key}</h2>
                <ul>
                    {uniqueTags[key].map(value => (
                        <li>{value}</li>
                    ))}
                </ul>
            </div>
        ))}
    </p> -->
    <div class="flex">
        {allProjects.map((project) => (
            <ProjectCard 
                url={`/projects/${project.slug}/`} 
                title={project.data.title} 
                imgUrl={project.data.image.url}
                imgAlt={project.data.image.alt}
                author={project.data.author}
                description={project.data.description}
                tags={allProjectTags.find(tag => tag.id === project.data.tags.id)}
            />
        ))}
    </div>
    <script>
        import '../scripts/header.js';
    </script>
</BaseLayout>
